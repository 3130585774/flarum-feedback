(()=>{var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var r in a)e.o(a,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:a[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};(()=>{"use strict";const t=flarum.reg.get("core","common/app");function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function r(e,t,r){return(t=function(e){var t=function(e){if("object"!=a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==a(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.n(t)().initializers.add("mcaxe-feedback-common",()=>{console.log("[mcaxe/flarum-feedback] Hello, forum and admin!")});const o=flarum.reg.get("core","admin/app");var n=e.n(o);const i=flarum.reg.get("core","admin/components/AdminPage");var s=e.n(i);const c=flarum.reg.get("core","common/components/Avatar");var d=e.n(c);const l=flarum.reg.get("core","common/components/LinkButton");var u=e.n(l);const f=flarum.reg.get("core","common/components/LoadingIndicator");var g=e.n(f);const p=flarum.reg.get("core","common/extend"),b=flarum.reg.get("core","admin/components/AdminNav");var h=e.n(b);n().initializers.add("mcaxe-feedback",()=>{(0,p.extend)(h().prototype,"items",function(e){e.add("feedback-link",m(u(),{icon:"fas fa-comment-dots",href:"/mcaxe-feedback"},"意见反馈"))}),n().routes["mcaxe-feedback"]={path:"/mcaxe-feedback",component:k}});class k extends(s()){constructor(){super(...arguments),r(this,"feedbacks",[]),r(this,"loading",!0),r(this,"pageOffset",0),r(this,"pageLimit",20)}headerInfo(){return{title:"用户反馈",description:"查看用户提交的反馈信息",icon:"fas fa-comment-dots",className:"FeedbackPage"}}oninit(e){super.oninit(e),this.loadFeedbacks()}loadFeedbacks(){this.loading=!0,n().request({method:"GET",url:n().forum.attribute("apiUrl")+`/mcaxe-flarum-feedbacks-list?page[offset]=${this.pageOffset}&page[limit]=${this.pageLimit}`}).then(e=>{n().store.pushPayload(e),this.feedbacks=e.data,this.loading=!1,m.redraw()})}prevPage(){this.pageOffset>=this.pageLimit&&(this.pageOffset-=this.pageLimit,this.loadFeedbacks())}nextPage(){this.pageOffset+=this.pageLimit,this.loadFeedbacks()}content(){return m("div",{className:"FeedbackPage-container"},this.loading?m(g(),null):m("div",{className:"FeedbackPage-grid"},this.feedbacks.map(e=>{const t=e.relationships?.user?.data,a=n().store.getById("users",t?.id);return a?m("div",{className:"FeedbackPage-card"},m("div",{className:"FeedbackPage-user-info"},m(d(),{user:a,className:"FeedbackPage-avatar"}),m("div",null,m("a",{href:`${n().forum.attribute("baseUrl")}/u/${a.username()}`,target:"_blank",rel:"noopener noreferrer",className:"FeedbackPage-username"},a.username()),m("p",{className:"FeedbackPage-timestamp"},new Date(e.attributes.createdAt).toLocaleString()))),m("p",{className:"FeedbackPage-feedback"},e.attributes.feedback)):null})),!this.loading&&m("div",{className:"FeedbackPage-pagination"},m("button",{className:"Button",onclick:()=>this.prevPage(),disabled:0===this.pageOffset},"上一页"),m("button",{className:"Button",onclick:()=>this.nextPage()},"下一页")))}}})(),module.exports={}})();
//# sourceMappingURL=admin.js.map