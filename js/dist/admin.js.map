{"version":3,"file":"admin.js","mappings":"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","sources":["webpack://@mcaxe/flarum-feedback/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://@mcaxe/flarum-feedback/./node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://@mcaxe/flarum-feedback/./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://@mcaxe/flarum-feedback/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://@mcaxe/flarum-feedback/./src/admin/index.tsx","webpack://@mcaxe/flarum-feedback/./src/common/index.ts","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'admin/app')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'admin/components/AdminNav')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'admin/components/AdminPage')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/app')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/components/Avatar')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/components/LinkButton')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/components/LoadingIndicator')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/extend')\"","webpack://@mcaxe/flarum-feedback/webpack/bootstrap","webpack://@mcaxe/flarum-feedback/webpack/runtime/compat get default export","webpack://@mcaxe/flarum-feedback/webpack/runtime/define property getters","webpack://@mcaxe/flarum-feedback/webpack/runtime/hasOwnProperty shorthand","webpack://@mcaxe/flarum-feedback/webpack/runtime/make namespace object","webpack://@mcaxe/flarum-feedback/./admin.ts"],"sourcesContent":["import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nexport { _defineProperty as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport app from 'flarum/admin/app';\nimport AdminPage from 'flarum/admin/components/AdminPage';\nimport Avatar from 'flarum/common/components/Avatar';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport { extend } from 'flarum/common/extend';\nimport AdminNav from 'flarum/admin/components/AdminNav';\napp.initializers.add('mcaxe-feedback', () => {\n  extend(AdminNav.prototype, 'items', function (items) {\n    items.add('feedback-link', m(LinkButton, {\n      icon: \"fas fa-comment-dots\",\n      href: \"/mcaxe-feedback\"\n    }, \"\\u610F\\u89C1\\u53CD\\u9988\"));\n  });\n  app.routes['mcaxe-feedback'] = {\n    path: '/mcaxe-feedback',\n    component: FeedbackPage\n  };\n});\nexport default class FeedbackPage extends AdminPage {\n  constructor() {\n    super(...arguments);\n    _defineProperty(this, \"feedbacks\", []);\n    _defineProperty(this, \"loading\", true);\n    _defineProperty(this, \"pageOffset\", 0);\n    _defineProperty(this, \"pageLimit\", 20);\n  }\n  headerInfo() {\n    return {\n      title: '用户反馈',\n      description: '查看用户提交的反馈信息',\n      icon: 'fas fa-comment-dots',\n      className: 'FeedbackPage'\n    };\n  }\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.loadFeedbacks();\n  }\n  loadFeedbacks() {\n    this.loading = true;\n    app.request({\n      method: 'GET',\n      url: app.forum.attribute('apiUrl') + `/mcaxe-flarum-feedbacks-list?page[offset]=${this.pageOffset}&page[limit]=${this.pageLimit}`\n    }).then(result => {\n      app.store.pushPayload(result);\n      this.feedbacks = result.data;\n      this.loading = false;\n      m.redraw();\n    });\n  }\n  prevPage() {\n    if (this.pageOffset >= this.pageLimit) {\n      this.pageOffset -= this.pageLimit;\n      this.loadFeedbacks();\n    }\n  }\n  nextPage() {\n    // if (this.feedbacks.length === this.pageLimit) {\n    this.pageOffset += this.pageLimit;\n    this.loadFeedbacks();\n    // }\n  }\n  content() {\n    return m(\"div\", {\n      className: \"FeedbackPage-container\"\n    }, this.loading ? m(LoadingIndicator, null) : m(\"div\", {\n      className: \"FeedbackPage-grid\"\n    }, this.feedbacks.map(item => {\n      const user = item.relationships?.user?.data;\n      const userModel = app.store.getById('users', user?.id);\n      if (!userModel) return null;\n      return m(\"div\", {\n        className: \"FeedbackPage-card\"\n      }, m(\"div\", {\n        className: \"FeedbackPage-user-info\"\n      }, m(Avatar, {\n        user: userModel,\n        className: \"FeedbackPage-avatar\"\n      }), m(\"div\", null, m(\"a\", {\n        href: `${app.forum.attribute('baseUrl')}/u/${userModel.username()}`,\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        className: \"FeedbackPage-username\"\n      }, userModel.username()), m(\"p\", {\n        className: \"FeedbackPage-timestamp\"\n      }, new Date(item.attributes.createdAt).toLocaleString()))), m(\"p\", {\n        className: \"FeedbackPage-feedback\"\n      }, item.attributes.feedback));\n    })), !this.loading && m(\"div\", {\n      className: \"FeedbackPage-pagination\"\n    }, m(\"button\", {\n      className: \"Button\",\n      onclick: () => this.prevPage(),\n      disabled: this.pageOffset === 0\n    }, \"\\u4E0A\\u4E00\\u9875\"), m(\"button\", {\n      className: \"Button\",\n      onclick: () => this.nextPage()\n    }, \"\\u4E0B\\u4E00\\u9875\")));\n  }\n}","import app from 'flarum/common/app';\napp.initializers.add('mcaxe-feedback-common', () => {\n  console.log('[mcaxe/flarum-feedback] Hello, forum and admin!');\n});","module.exports = flarum.reg.get('core', 'admin/app');","module.exports = flarum.reg.get('core', 'admin/components/AdminNav');","module.exports = flarum.reg.get('core', 'admin/components/AdminPage');","module.exports = flarum.reg.get('core', 'common/app');","module.exports = flarum.reg.get('core', 'common/components/Avatar');","module.exports = flarum.reg.get('core', 'common/components/LinkButton');","module.exports = flarum.reg.get('core', 'common/components/LoadingIndicator');","module.exports = flarum.reg.get('core', 'common/extend');","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\tflarum.reg._webpack_runtimes[\"mcaxe-feedback\"] ||= __webpack_require__;// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export * from './src/common';\nexport * from './src/admin';\n"],"names":["toPropertyKey","_defineProperty","e","r","t","Object","defineProperty","value","enumerable","configurable","writable","default","_typeof","toPrimitive","Symbol","i","call","TypeError","String","Number","o","iterator","constructor","prototype"],"sourceRoot":""}