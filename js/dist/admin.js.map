{"version":3,"file":"admin.js","mappings":"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","sources":["webpack://@mcaxe/flarum-feedback/webpack/bootstrap","webpack://@mcaxe/flarum-feedback/webpack/runtime/compat get default export","webpack://@mcaxe/flarum-feedback/webpack/runtime/define property getters","webpack://@mcaxe/flarum-feedback/webpack/runtime/hasOwnProperty shorthand","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/app')\"","webpack://@mcaxe/flarum-feedback/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://@mcaxe/flarum-feedback/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://@mcaxe/flarum-feedback/./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://@mcaxe/flarum-feedback/./node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://@mcaxe/flarum-feedback/./src/common/index.ts","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'admin/app')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'admin/components/AdminPage')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/components/Avatar')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/components/LinkButton')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/components/LoadingIndicator')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/extend')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'admin/components/AdminNav')\"","webpack://@mcaxe/flarum-feedback/./src/admin/index.tsx"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/app');","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nexport { _defineProperty as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","import app from 'flarum/common/app';\napp.initializers.add('mcaxe-feedback-common', () => {\n  console.log('[mcaxe/flarum-feedback] Hello, forum and admin!');\n});","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'admin/app');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'admin/components/AdminPage');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Avatar');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/LinkButton');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/LoadingIndicator');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/extend');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'admin/components/AdminNav');","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport app from 'flarum/admin/app';\nimport AdminPage from 'flarum/admin/components/AdminPage';\nimport Avatar from 'flarum/common/components/Avatar';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport { extend } from 'flarum/common/extend';\nimport AdminNav from 'flarum/admin/components/AdminNav';\napp.initializers.add('mcaxe-feedback', () => {\n  extend(AdminNav.prototype, 'items', function (items) {\n    items.add('feedback-link', m(LinkButton, {\n      icon: \"fas fa-comment-dots\",\n      href: \"/mcaxe-feedback\"\n    }, \"\\u610F\\u89C1\\u53CD\\u9988\"));\n  });\n  app.routes['mcaxe-feedback'] = {\n    path: '/mcaxe-feedback',\n    component: FeedbackPage\n  };\n});\nexport default class FeedbackPage extends AdminPage {\n  constructor() {\n    super(...arguments);\n    _defineProperty(this, \"feedbacks\", []);\n    _defineProperty(this, \"loading\", true);\n    _defineProperty(this, \"pageOffset\", 0);\n    _defineProperty(this, \"pageLimit\", 20);\n  }\n  headerInfo() {\n    return {\n      title: '用户反馈',\n      description: '查看用户提交的反馈信息',\n      icon: 'fas fa-comment-dots',\n      className: 'FeedbackPage'\n    };\n  }\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.loadFeedbacks();\n  }\n  loadFeedbacks() {\n    this.loading = true;\n    app.request({\n      method: 'GET',\n      url: app.forum.attribute('apiUrl') + `/mcaxe-flarum-feedbacks-list?page[offset]=${this.pageOffset}&page[limit]=${this.pageLimit}`\n    }).then(result => {\n      app.store.pushPayload(result);\n      this.feedbacks = result.data;\n      this.loading = false;\n      m.redraw();\n    });\n  }\n  prevPage() {\n    if (this.pageOffset >= this.pageLimit) {\n      this.pageOffset -= this.pageLimit;\n      this.loadFeedbacks();\n    }\n  }\n  nextPage() {\n    // if (this.feedbacks.length === this.pageLimit) {\n    this.pageOffset += this.pageLimit;\n    this.loadFeedbacks();\n    // }\n  }\n  content() {\n    return m(\"div\", {\n      className: \"FeedbackPage-container\"\n    }, this.loading ? m(LoadingIndicator, null) : m(\"div\", {\n      className: \"FeedbackPage-grid\"\n    }, this.feedbacks.map(item => {\n      const user = item.relationships?.user?.data;\n      const userModel = app.store.getById('users', user?.id);\n      if (!userModel) return null;\n      return m(\"div\", {\n        className: \"FeedbackPage-card\"\n      }, m(\"div\", {\n        className: \"FeedbackPage-user-info\"\n      }, m(Avatar, {\n        user: userModel,\n        className: \"FeedbackPage-avatar\"\n      }), m(\"div\", null, m(\"a\", {\n        href: `${app.forum.attribute('baseUrl')}/u/${userModel.username()}`,\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        className: \"FeedbackPage-username\"\n      }, userModel.username()), m(\"p\", {\n        className: \"FeedbackPage-timestamp\"\n      }, new Date(item.attributes.createdAt).toLocaleString()))), m(\"p\", {\n        className: \"FeedbackPage-feedback\"\n      }, item.attributes.feedback));\n    })), !this.loading && m(\"div\", {\n      className: \"FeedbackPage-pagination\"\n    }, m(\"button\", {\n      className: \"Button\",\n      onclick: () => this.prevPage(),\n      disabled: this.pageOffset === 0\n    }, \"\\u4E0A\\u4E00\\u9875\"), m(\"button\", {\n      className: \"Button\",\n      onclick: () => this.nextPage()\n    }, \"\\u4E0B\\u4E00\\u9875\")));\n  }\n}"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","reg","_typeof","Symbol","iterator","constructor","_defineProperty","e","r","t","i","toPrimitive","TypeError","String","toPropertyKey","value","configurable","writable","add","console","log","extend","items","m","icon","href","path","component","FeedbackPage","super","arguments","this","headerInfo","title","description","className","oninit","vnode","loadFeedbacks","loading","method","url","attribute","pageOffset","pageLimit","then","result","pushPayload","feedbacks","data","redraw","prevPage","nextPage","content","map","item","user","relationships","userModel","getById","id","username","target","rel","Date","attributes","createdAt","toLocaleString","feedback","onclick","disabled"],"sourceRoot":""}