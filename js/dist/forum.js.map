{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@mcaxe/flarum-feedback/webpack/bootstrap","webpack://@mcaxe/flarum-feedback/webpack/runtime/compat get default export","webpack://@mcaxe/flarum-feedback/webpack/runtime/define property getters","webpack://@mcaxe/flarum-feedback/webpack/runtime/hasOwnProperty shorthand","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/app')\"","webpack://@mcaxe/flarum-feedback/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://@mcaxe/flarum-feedback/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://@mcaxe/flarum-feedback/./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://@mcaxe/flarum-feedback/./node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://@mcaxe/flarum-feedback/./src/common/index.ts","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'forum/app')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/extend')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'forum/components/IndexPage')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/components/Button')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/components/Modal')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/utils/Stream')\"","webpack://@mcaxe/flarum-feedback/./src/forum/index.tsx"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/app');","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nexport { _defineProperty as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","import app from 'flarum/common/app';\napp.initializers.add('mcaxe-feedback-common', () => {\n  console.log('[mcaxe/flarum-feedback] Hello, forum and admin!');\n});","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/app');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/extend');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/components/IndexPage');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Button');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Modal');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/utils/Stream');","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport Button from 'flarum/common/components/Button';\nimport Modal from 'flarum/common/components/Modal';\nimport Stream from 'flarum/common/utils/Stream';\nclass FeedbackModal extends Modal {\n  constructor() {\n    super(...arguments);\n    _defineProperty(this, \"feedbackText\", void 0);\n    _defineProperty(this, \"error\", void 0);\n  }\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.feedbackText = Stream('');\n    this.loading = false;\n    this.error = null;\n  }\n  view() {\n    return m(\"div\", {\n      className: `Modal ${this.className()}`,\n      role: \"dialog\",\n      \"aria-modal\": \"true\"\n    }, m(\"div\", {\n      className: \"Modal-content\"\n    }, m(\"header\", {\n      className: \"Modal-header\"\n    }, m(\"h3\", {\n      className: \"Modal-title\"\n    }, this.title())), this.content(), this.footer()));\n  }\n  className() {\n    return 'mcaxe-feedback-modal Modal--small';\n  }\n  title() {\n    return '意见反馈';\n  }\n  content() {\n    return m(\"div\", {\n      className: \"Modal-body\"\n    }, m(\"textarea\", {\n      className: \"FormControl\",\n      placeholder: \"\\u8BF7\\u8F93\\u5165\\u60A8\\u7684\\u610F\\u89C1\",\n      value: this.feedbackText(),\n      oninput: e => this.feedbackText(e.target.value),\n      rows: \"20\",\n      cols: \"50\",\n      required: true,\n      style: {\n        resize: 'none'\n      }\n    }), this.error && m(\"p\", {\n      className: \"error\"\n    }, this.error));\n  }\n  footer() {\n    return m(\"div\", {\n      className: \"Modal-footer\",\n      style: {\n        display: 'flex',\n        gap: '12px'\n      }\n    }, m(Button, {\n      className: \"Button Button--primary\",\n      style: {\n        flex: 1\n      },\n      loading: this.loading,\n      onclick: () => this.submit()\n    }, \"\\u63D0\\u4EA4\"), m(Button, {\n      className: \"Button\",\n      style: {\n        flex: 1\n      },\n      onclick: () => this.hide()\n    }, \"\\u53D6\\u6D88\"));\n  }\n  submit() {\n    const text = this.feedbackText().trim();\n    if (!text) {\n      this.error = '反馈内容不能为空';\n      return;\n    }\n    this.loading = true;\n    this.error = null;\n    app.request({\n      method: 'POST',\n      url: app.forum.attribute('apiUrl') + '/mcaxe-flarum-feedbacks',\n      body: {\n        feedback: text\n      }\n    }).then(() => {\n      this.loading = false;\n      this.hide();\n      app.alerts.show({\n        type: 'success'\n      }, '反馈提交成功，谢谢！');\n    }).catch(() => {\n      this.loading = false;\n      this.error = '提交失败，请稍后重试';\n    });\n  }\n}\napp.initializers.add('mcaxe-feedback', () => {\n  console.log('[mcaxe/flarum-feedback] Hello, forum!');\n  extend(IndexPage.prototype, 'view', function (vdom) {\n    const FeedbackButton = m(\"div\", {\n      className: \"mcaxe-feedback-button\"\n    }, m(Button, {\n      className: \"Button Button--primary\",\n      onclick: () => app.modal.show(FeedbackModal)\n    }, \"\\u610F\\u89C1\\u53CD\\u9988\"));\n    if (!Array.isArray(vdom.children)) {\n      vdom.children = vdom.children ? [vdom.children] : [];\n    }\n    vdom.children.push(FeedbackButton);\n  });\n});"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","reg","_typeof","Symbol","iterator","constructor","_defineProperty","e","r","t","i","toPrimitive","TypeError","String","toPropertyKey","value","configurable","writable","add","console","log","FeedbackModal","super","arguments","this","oninit","vnode","feedbackText","loading","error","view","m","className","role","title","content","footer","placeholder","oninput","target","rows","cols","required","style","resize","display","gap","flex","onclick","submit","hide","text","trim","method","url","attribute","body","feedback","then","show","type","catch","extend","vdom","FeedbackButton","Array","isArray","children","push"],"sourceRoot":""}