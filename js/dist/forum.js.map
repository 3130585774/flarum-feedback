{"version":3,"file":"forum.js","mappings":";;;;;;;;;;;;;;;;AAA+C;AAC/C,SAASC,eAAeA,CAACC,CAAC,EAAEC,CAAC,EAAEC,CAAC,EAAE;EAChC,OAAO,CAACD,CAAC,GAAGH,6DAAa,CAACG,CAAC,CAAC,KAAKD,CAAC,GAAGG,MAAM,CAACC,cAAc,CAACJ,CAAC,EAAEC,CAAC,EAAE;IAC/DI,KAAK,EAAEH,CAAC;IACRI,UAAU,EAAE,CAAC,CAAC;IACdC,YAAY,EAAE,CAAC,CAAC;IAChBC,QAAQ,EAAE,CAAC;EACb,CAAC,CAAC,GAAGR,CAAC,CAACC,CAAC,CAAC,GAAGC,CAAC,EAAEF,CAAC;AAClB;;;;;;;;;;;;;;;;;ACRkC;AAClC,SAASW,WAAWA,CAACT,CAAC,EAAED,CAAC,EAAE;EACzB,IAAI,QAAQ,IAAIS,sDAAO,CAACR,CAAC,CAAC,IAAI,CAACA,CAAC,EAAE,OAAOA,CAAC;EAC1C,IAAIF,CAAC,GAAGE,CAAC,CAACU,MAAM,CAACD,WAAW,CAAC;EAC7B,IAAI,KAAK,CAAC,KAAKX,CAAC,EAAE;IAChB,IAAIa,CAAC,GAAGb,CAAC,CAACc,IAAI,CAACZ,CAAC,EAAED,CAAC,IAAI,SAAS,CAAC;IACjC,IAAI,QAAQ,IAAIS,sDAAO,CAACG,CAAC,CAAC,EAAE,OAAOA,CAAC;IACpC,MAAM,IAAIE,SAAS,CAAC,8CAA8C,CAAC;EACrE;EACA,OAAO,CAAC,QAAQ,KAAKd,CAAC,GAAGe,MAAM,GAAGC,MAAM,EAAEf,CAAC,CAAC;AAC9C;;;;;;;;;;;;;;;;;;ACVkC;AACS;AAC3C,SAASJ,aAAaA,CAACI,CAAC,EAAE;EACxB,IAAIW,CAAC,GAAGF,2DAAW,CAACT,CAAC,EAAE,QAAQ,CAAC;EAChC,OAAO,QAAQ,IAAIQ,sDAAO,CAACG,CAAC,CAAC,GAAGA,CAAC,GAAGA,CAAC,GAAG,EAAE;AAC5C;;;;;;;;;;;;;;;;ACLA,SAASH,OAAOA,CAACQ,CAAC,EAAE;EAClB,yBAAyB;;EAEzB,OAAOR,OAAO,GAAG,UAAU,IAAI,OAAOE,MAAM,IAAI,QAAQ,IAAI,OAAOA,MAAM,CAACO,QAAQ,GAAG,UAAUD,CAAC,EAAE;IAChG,OAAO,OAAOA,CAAC;EACjB,CAAC,GAAG,UAAUA,CAAC,EAAE;IACf,OAAOA,CAAC,IAAI,UAAU,IAAI,OAAON,MAAM,IAAIM,CAAC,CAACE,WAAW,KAAKR,MAAM,IAAIM,CAAC,KAAKN,MAAM,CAACS,SAAS,GAAG,QAAQ,GAAG,OAAOH,CAAC;EACrH,CAAC,EAAER,OAAO,CAACQ,CAAC,CAAC;AACf;;;;;;;;;;;;;;;ACRoC;AACpC,qEAAgB;AAChB;AACA,CAAC,E;;;;;;;;;;;;;;;;;;;;;;;;;ACHuE;AACrC;AACW;AACY;AACL;AACF;AACH;AAChD,4BAA4B,uEAAK;AACjC;AACA;AACA,IAAI,qFAAe;AACnB,IAAI,qFAAe;AACnB;AACA;AACA;AACA,wBAAwB,iEAAM;AAC9B;AACA;AACA;AACA;AACA;AACA,0BAA0B,iBAAiB;AAC3C;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,IAAI,wEAAM;AACf;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK,qBAAqB,wEAAM;AAChC;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,+DAAW;AACf;AACA,WAAW,6DAAS;AACpB;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,MAAM,8DAAU;AAChB;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,oEAAgB;AAChB;AACA,EAAE,4DAAM,CAAC,oFAAmB;AAC5B;AACA;AACA,KAAK,IAAI,wEAAM;AACf;AACA,qBAAqB,6DAAS;AAC9B,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH,CAAC,E;;;;;;;;;;;ACtHD,sD;;;;;;;;;;;ACAA,oE;;;;;;;;;;;ACAA,mE;;;;;;;;;;;ACAA,yD;;;;;;;;;;;ACAA,+D;;;;;;;;;;;ACAA,qD;;;;;;;;;;;ACAA,sE;;;;;;UCAA;UACA;;UAEA;UACA;UACA,wEAAwE;UACxE;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA,E;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA,E;;;;;WCPA,wF;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D,E;;;;;;;;;;;;;;ACN6B","sources":["webpack://@mcaxe/flarum-feedback/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://@mcaxe/flarum-feedback/./node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://@mcaxe/flarum-feedback/./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://@mcaxe/flarum-feedback/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://@mcaxe/flarum-feedback/./src/common/index.ts","webpack://@mcaxe/flarum-feedback/./src/forum/index.tsx","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/app')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/components/Button')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/components/Modal')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/extend')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'common/utils/Stream')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'forum/app')\"","webpack://@mcaxe/flarum-feedback/external root \"flarum.reg.get('core', 'forum/components/IndexPage')\"","webpack://@mcaxe/flarum-feedback/webpack/bootstrap","webpack://@mcaxe/flarum-feedback/webpack/runtime/compat get default export","webpack://@mcaxe/flarum-feedback/webpack/runtime/define property getters","webpack://@mcaxe/flarum-feedback/webpack/runtime/hasOwnProperty shorthand","webpack://@mcaxe/flarum-feedback/webpack/runtime/make namespace object","webpack://@mcaxe/flarum-feedback/./forum.ts"],"sourcesContent":["import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nexport { _defineProperty as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import app from 'flarum/common/app';\napp.initializers.add('mcaxe-feedback-common', () => {\n  console.log('[mcaxe/flarum-feedback] Hello, forum and admin!');\n});","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport Button from 'flarum/common/components/Button';\nimport Modal from 'flarum/common/components/Modal';\nimport Stream from 'flarum/common/utils/Stream';\nclass FeedbackModal extends Modal {\n  constructor() {\n    super(...arguments);\n    _defineProperty(this, \"feedbackText\", void 0);\n    _defineProperty(this, \"error\", void 0);\n  }\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.feedbackText = Stream('');\n    this.loading = false;\n    this.error = null;\n  }\n  view() {\n    return m(\"div\", {\n      className: `Modal ${this.className()}`,\n      role: \"dialog\",\n      \"aria-modal\": \"true\"\n    }, m(\"div\", {\n      className: \"Modal-content\"\n    }, m(\"header\", {\n      className: \"Modal-header\"\n    }, m(\"h3\", {\n      className: \"Modal-title\"\n    }, this.title())), this.content(), this.footer()));\n  }\n  className() {\n    return 'mcaxe-feedback-modal Modal--small';\n  }\n  title() {\n    return '意见反馈';\n  }\n  content() {\n    return m(\"div\", {\n      className: \"Modal-body\"\n    }, m(\"textarea\", {\n      className: \"FormControl\",\n      placeholder: \"\\u8BF7\\u8F93\\u5165\\u60A8\\u7684\\u610F\\u89C1\",\n      value: this.feedbackText(),\n      oninput: e => this.feedbackText(e.target.value),\n      rows: \"20\",\n      cols: \"50\",\n      required: true,\n      style: {\n        resize: 'none'\n      }\n    }), this.error && m(\"p\", {\n      className: \"error\"\n    }, this.error));\n  }\n  footer() {\n    return m(\"div\", {\n      className: \"Modal-footer\",\n      style: {\n        display: 'flex',\n        gap: '12px'\n      }\n    }, m(Button, {\n      className: \"Button Button--primary\",\n      style: {\n        flex: 1\n      },\n      loading: this.loading,\n      onclick: () => this.submit()\n    }, \"\\u63D0\\u4EA4\"), m(Button, {\n      className: \"Button\",\n      style: {\n        flex: 1\n      },\n      onclick: () => this.hide()\n    }, \"\\u53D6\\u6D88\"));\n  }\n  submit() {\n    const text = this.feedbackText().trim();\n    if (!text) {\n      this.error = '反馈内容不能为空';\n      return;\n    }\n    this.loading = true;\n    this.error = null;\n    app.request({\n      method: 'POST',\n      url: app.forum.attribute('apiUrl') + '/mcaxe-flarum-feedbacks',\n      body: {\n        feedback: text\n      }\n    }).then(() => {\n      this.loading = false;\n      this.hide();\n      app.alerts.show({\n        type: 'success'\n      }, '反馈提交成功，谢谢！');\n    }).catch(() => {\n      this.loading = false;\n      this.error = '提交失败，请稍后重试';\n    });\n  }\n}\napp.initializers.add('mcaxe-feedback', () => {\n  console.log('[mcaxe/flarum-feedback] Hello, forum!');\n  extend(IndexPage.prototype, 'view', function (vdom) {\n    const FeedbackButton = m(\"div\", {\n      className: \"mcaxe-feedback-button\"\n    }, m(Button, {\n      className: \"Button Button--primary\",\n      onclick: () => app.modal.show(FeedbackModal)\n    }, \"\\u610F\\u89C1\\u53CD\\u9988\"));\n    if (!Array.isArray(vdom.children)) {\n      vdom.children = vdom.children ? [vdom.children] : [];\n    }\n    vdom.children.push(FeedbackButton);\n  });\n});","module.exports = flarum.reg.get('core', 'common/app');","module.exports = flarum.reg.get('core', 'common/components/Button');","module.exports = flarum.reg.get('core', 'common/components/Modal');","module.exports = flarum.reg.get('core', 'common/extend');","module.exports = flarum.reg.get('core', 'common/utils/Stream');","module.exports = flarum.reg.get('core', 'forum/app');","module.exports = flarum.reg.get('core', 'forum/components/IndexPage');","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\tflarum.reg._webpack_runtimes[\"mcaxe-feedback\"] ||= __webpack_require__;// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export * from './src/common';\nexport * from './src/forum';\n"],"names":["toPropertyKey","_defineProperty","e","r","t","Object","defineProperty","value","enumerable","configurable","writable","default","_typeof","toPrimitive","Symbol","i","call","TypeError","String","Number","o","iterator","constructor","prototype"],"sourceRoot":""}